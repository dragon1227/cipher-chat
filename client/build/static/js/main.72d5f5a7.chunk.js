(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{138:function(e,t){e.exports="data:image/jpeg;base64,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"},143:function(e,t,a){e.exports=a(310)},148:function(e,t,a){},149:function(e,t,a){},193:function(e,t){},195:function(e,t){},230:function(e,t){},231:function(e,t){},273:function(e,t,a){},274:function(e,t,a){},298:function(e,t){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},310:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(137),o=a.n(c),u=(a(148),a(149),function(){return r.a.createElement("footer",{className:"container"},r.a.createElement("small",null," CipherChat | About"))}),s=a(4),l=a.n(s),i=a(10),m=a(6),p=a(39),f=a.n(p),b={get:f.a.get,post:f.a.post,put:f.a.put,delete:f.a.delete},h="/api/users",g=function(){var e=Object(i.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(h);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(i.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.post(h,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(l.a.mark(function e(t,a){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.put("".concat(h,"/").concat(t),a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),d=function(){var e=Object(i.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get("".concat(h,"/").concat(t));case 2:return a=e.sent,n=a.data,e.abrupt("return",Boolean(n));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b.post("".concat(h,"/auth/"),t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("userToken"),a={headers:{"x-auth-token":t}},e.abrupt("return",b.get("".concat(h,"/auth"),a));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),k=a(21),S=a.n(k),j=S.a.SHA256,w=function(e){var t=e.history,a=Object(n.useState)(""),c=Object(m.a)(a,2),o=c[0],u=c[1],s=Object(n.useState)(""),p=Object(m.a)(s,2),f=p[0],b=p[1],h=function(){var e=Object(i.a)(l.a.mark(function e(a){var n,r,c,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,d(o);case 3:if(e.sent){e.next=6;break}return e.abrupt("return",alert("User with the username not found."));case 6:return n=j(o+f).toString(),r=j(n+f).toString(),localStorage.setItem("pvk_phrase",r),e.prev=9,e.next=12,E({auth:n});case 12:c=e.sent,u=c.data,localStorage.setItem("userToken",u),alert("Account authenticated!"),t.push("/chat"),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(9),console.log(e.t0),localStorage.clear();case 23:case"end":return e.stop()}},e,null,[[9,19]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:h},r.a.createElement("input",{className:"mb",type:"text",placeholder:"Pseudoname",value:o,onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement("input",{className:"mb",type:"password",placeholder:"Secret Password",value:f,onChange:function(e){var t=e.target;return b(t.value)}}),r.a.createElement("input",{className:"btn-dark",type:"submit",value:"Login"}),r.a.createElement("a",{href:"/register"},"Don't have an account yet?")))},O=a(18),B=a.n(O),x=S.a.SHA256,Q=function(e){var t=e.history,a=Object(n.useState)(""),c=Object(m.a)(a,2),o=c[0],u=c[1],s=Object(n.useState)(""),p=Object(m.a)(s,2),f=p[0],b=p[1],h=function(){var e=Object(i.a)(l.a.mark(function e(a){var n,r,c,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,d(o);case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",alert("User with the username already exists"));case 6:return n=x(o+f).toString(),r=x(n+f).toString(),c=B.a.generateRSAKey(r,1024),u=B.a.publicKeyString(c),e.prev=10,e.next=13,v({username:o,auth:n,publicKey:u});case 13:alert("Account has been created."),t.push("/login"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),console.log(e.t0);case 20:case"end":return e.stop()}},e,null,[[10,17]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:h},r.a.createElement("input",{className:"mb",type:"text",placeholder:"Pseudoname",value:o,onChange:function(e){var t=e.target;return u(t.value)}}),r.a.createElement("input",{className:"mb",type:"password",placeholder:"Secret Password",value:f,onChange:function(e){var t=e.target;return b(t.value)}}),r.a.createElement("input",{className:"btn-dark",type:"submit",value:"Register"}),r.a.createElement("a",{href:"/login"},"Already have an account?")))},U=a(23),N=a(142),C=a(141),D=(a(273),a(274),function(e){var t=e.userKeys,a=e.isSecret,n=e.username,c=e.name,o=e.message,u=e.timestamp,s=(c=a?B.a.decrypt(c,t.pvk).plaintext:c)===n?"float-right max-width":"",l=c===n?"float-right text-align-right":"",i=c===n?"You":c;return r.a.createElement("div",{className:s},r.a.createElement("div",{id:"bubble-container",className:l},r.a.createElement("b",null,i)," ",r.a.createElement("br",null),r.a.createElement("div",{id:"message-bubble"},a?B.a.decrypt(o,t.pvk).plaintext:o)," ",r.a.createElement("br",null),r.a.createElement("small",{id:"timestamp"},function(){a&&(u=B.a.decrypt(u,t.pvk).plaintext);var e=new Date(u),n=e.getMonth(),r=e.getDate(),c=e.getFullYear(),o=e.getHours(),s=e.getMinutes();return"".concat(n,"/").concat(r,"/").concat(c," - ").concat(o,":").concat(s)}())))}),q=a(51),I=a.n(q),H=function(e){var t=e.message,a=e.sendMessage,n=e.handleMessageChange;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-form"},r.a.createElement("form",{onSubmit:a},r.a.createElement("input",{value:t,onChange:n,placeholder:"Type a message...",type:"text"}))),r.a.createElement("div",{className:"message-submit"},r.a.createElement("button",{onClick:a},r.a.createElement("i",{className:"fas fa-paper-plane"}))))},R=I()(),F=function(e){var t=e.user,a=(e.match,e.channel),c=Object(n.useState)(""),o=Object(m.a)(c,2),u=o[0],s=o[1],l=Object(n.useState)([]),i=Object(m.a)(l,2),p=i[0],f=i[1];Object(n.useEffect)(function(){return f([]),R.connect(),console.log({channel:a,isSecret:b,userKeys:h,filter:g}),R.emit("get-chats",g),function(){R.disconnect()}},[a]),R.on("return-chats",function(e){v(e)}),R.on("new-message",function(e){v([].concat(Object(C.a)(p),[e]))});var b="global"!==a,h=function(){var e=localStorage.getItem("pvk_phrase"),t=B.a.generateRSAKey(e,1024);return{pvk:t,pbk:B.a.publicKeyString(t)}}(),g=b?{channel:a,pbkHash:Object(k.SHA256)(h.pbk).toString()}:{channel:a},v=function(e){f(e),y()},A=function(){var e=t.username,a=(new Date).toString(),n=localStorage.getItem("chatmate_pbk"),r=d({name:e,message:u,timestamp:a},h.pbk);R.emit("send-secret-msg-self",r);var c=d({name:e,message:u,timestamp:a},n);R.emit("send-secret-msg",c)},d=function(e,t){for(var n in e)e[n]=B.a.encrypt(e[n],t).cipher;return e.pbkHash=Object(k.SHA256)(t).toString(),e.channel=a,e},E=function(){var e={name:t.username,channel:a,message:u,timestamp:new Date};R.emit("send-message",e)},y=function(){var e=document.getElementById("chatbox");e.scrollTop=e.scrollHeight};return r.a.createElement("div",{className:"grid-container chatbox-container"},r.a.createElement("div",{id:"chatbox"},0===p.length?r.a.createElement("div",{className:"chat-notif"},"No messages yet. Say hello!"):p.map(function(e){return r.a.createElement(D,Object.assign({key:p.indexOf(e),username:t.username,userKeys:h,isSecret:b},e))})),r.a.createElement(H,{message:u,sendMessage:function(e){e.preventDefault(),b?A():E(),s("")},handleMessageChange:function(e){var t=e.target;s(t.value)}}))},P=S.a.MD5,V=function(e){var t=e.user,a=e.currUser,n=e.history,c=e.setChannel;return r.a.createElement("div",{className:"container-item mb"},r.a.createElement("b",null,t.username),r.a.createElement("button",{onClick:function(){var e=[t.publicKey,a.publicKey].sort(),r=P(e.join()).toString();localStorage.setItem("chatmate_pbk",t.publicKey),c(r),n.push("/chat/ch/"+r)}}," ",r.a.createElement("i",{className:"fas fa-comment"})))},G=(a(301),function(e){var t=e.user,a=e.history,c=e.setChannel,o=Object(n.useState)([]),u=Object(m.a)(o,2),s=u[0],p=u[1],f=Object(n.useState)(""),b=Object(m.a)(f,2),h=b[0],v=b[1];return Object(n.useEffect)(function(){!function(){var e=Object(i.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:t=e.sent,a=t.data,p(a);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"list mb"},s.map(function(e){return r.a.createElement(V,{key:s.indexOf(e),user:e,currUser:t,history:a,setChannel:c})})),r.a.createElement("input",{value:h,onChange:function(e){var t=e.target;return v(t.value)},placeholder:"Search for someone to chat..."}))}),K=(a(302),a(138)),Y=a.n(K),M=function(){return r.a.createElement("div",{id:"display-pic"},r.a.createElement("img",{alt:"anon",src:Y.a,width:"42"}))},W=function(e){var t=e.username;return r.a.createElement("div",{id:"display-name"},r.a.createElement("b",null,t||"Loading..."))},J=function(e){var t=e.bio,a=e.onSave,c=Object(n.useState)(!1),o=Object(m.a)(c,2),u=o[0],s=o[1],l=Object(n.useState)(""),i=Object(m.a)(l,2),p=i[0],f=i[1],b=function(){return s(!u)};return Object(n.useEffect)(function(){f(t)},[t]),r.a.createElement("div",{id:"display-bio"},u?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{maxLength:"50",value:p,onChange:function(e){var t=e.target;return f(t.value)}}),r.a.createElement("i",{onClick:function(){if(t===p)return b();a(p),b()},className:"fas fa-save"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("small",null,t||"bio"),r.a.createElement("i",{onClick:b,className:"fas fa-edit"})))},T=function(e){var t=e.user,a=e.onUpdateBio;return r.a.createElement("div",{className:"container grid-container"},r.a.createElement(M,null),r.a.createElement(W,{username:t.username}),r.a.createElement(J,{onSave:a,bio:t.bio}),r.a.createElement("div",{onClick:function(){localStorage.clear(),window.location="/"},id:"logout"},r.a.createElement("button",null,r.a.createElement("i",{className:"fas fa-sign-out-alt"}))))},Z=(a(303),function(e){var t=e.fa,a=e.label,n=e.handleClick;return r.a.createElement("div",null,r.a.createElement("button",{onClick:n},r.a.createElement("i",{className:t})," ",a))}),X=function(e){var t=e.history,a=e.setChannel,c=Object(n.useState)([{fa:"fas fa-search",label:"",handleClick:function(){return t.push("/chat/search")}},{fa:"fas fa-globe",label:"Global",handleClick:function(){t.push("/chat/ch/global"),a("global")}}]),o=Object(m.a)(c,2),u=o[0];o[1];return r.a.createElement("div",{className:"container-item nav mb"},r.a.createElement("div",{className:"nav-grid"},u.map(function(e){return r.a.createElement(Z,Object.assign({key:u.indexOf(e)},e))})))},L=(a(304),I()()),z=function(e){var t=e.history,a=Object(n.useState)({}),c=Object(m.a)(a,2),o=c[0],u=c[1],s=Object(n.useState)("global"),p=Object(m.a)(s,2),f=p[0],b=p[1];Object(n.useEffect)(function(){L?console.log("Socket Connected!"):console.error("Sockeet connection failed."),function(){var e=Object(i.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:t=e.sent,a=t.data,u(a);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[]);var h=function(){var e=Object(i.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(N.a)({},o)).bio=t,e.prev=2,e.next=5,A(o._id,a);case 5:u(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{onUpdateBio:h,history:t,user:o}),r.a.createElement("div",{className:"container chat"},r.a.createElement(X,{history:t,setChannel:b}),r.a.createElement(U.d,null,r.a.createElement(U.b,{path:"/chat/ch/:channel",render:function(e){return r.a.createElement(F,Object.assign({},e,{user:o,channel:f}))}}),r.a.createElement(U.b,{path:"/chat/list",render:function(e){return r.a.createElement(G,Object.assign({},e,{user:o,setChannel:b}))}}),r.a.createElement(U.a,{from:"/chat",to:"/chat/list"}))))};var _=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(U.d,null,r.a.createElement(U.b,{path:"/chat",component:z}),r.a.createElement(U.b,{path:"/login",component:w}),r.a.createElement(U.b,{path:"/register",component:Q}),r.a.createElement(U.a,{from:"/",to:"/login"})),r.a.createElement(u,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(309);var $=a(50);o.a.render(r.a.createElement($.a,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[143,1,2]]]);
//# sourceMappingURL=main.72d5f5a7.chunk.js.map